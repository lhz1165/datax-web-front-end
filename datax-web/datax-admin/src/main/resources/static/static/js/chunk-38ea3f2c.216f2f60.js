(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38ea3f2c"],{"1e31":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-page-header",{on:{back:t.goBack}},[a("template",{slot:"content"},[a("span",[t._v("创建视图")]),t._v(" "),a("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"}},[t._v(t._s(t.datasourceName))]),t._v(" "),t.schema?a("el-tag",{staticStyle:{"margin-left":"5px"},attrs:{size:"small",type:"info"}},[t._v(t._s(t.schema))]):t._e()],1)],2),t._v(" "),a("el-card",{staticClass:"form-card"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("视图 SQL")])]),t._v(" "),a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"SQL语句"}},[a("el-input",{attrs:{type:"textarea",rows:10,placeholder:"请输入创建视图的 SQL，例如：CREATE VIEW view_name AS SELECT ... "},model:{value:t.viewSql,callback:function(e){t.viewSql=e},expression:"viewSql"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"footer-actions"},[a("el-button",{on:{click:t.goBack}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.submitting},on:{click:t.handleCreateView}},[t._v("创建视图")])],1)],1)},n=[],u=(a("6762"),a("2fdb"),a("c5f6"),a("f352")),i={name:"CreateView",data:function(){return{datasourceId:null,datasourceName:"",datasourceType:"",schema:"",viewSql:"",submitting:!1}},created:function(){this.initFromRoute()},methods:{initFromRoute:function(){this.datasourceId=Number(this.$route.query.datasourceId),this.datasourceName=this.$route.query.datasourceName||"未知数据源",this.datasourceType=this.$route.query.datasourceType||"",this.schema=this.$route.query.schema||""},goBack:function(){this.$router.back()},handleCreateView:function(){var t=this;this.viewSql&&this.viewSql.toLowerCase().includes("create view")?(this.submitting=!0,Object(u["e"])({datasourceId:this.datasourceId,viewSql:this.viewSql}).then((function(){t.submitting=!1,t.$message.success("视图创建成功"),t.$router.push({path:"/datax/integration/database",query:{datasourceId:t.datasourceId,datasourceName:t.datasourceName,datasourceType:t.datasourceType,schema:t.schema,refresh:Date.now()}})})).catch((function(e){t.submitting=!1,t.$message.error("创建视图失败: "+(e.message||"未知错误"))}))):this.$message.warning("请输入包含 CREATE VIEW 的视图 SQL")}}},c=i,s=(a("c8bc"),a("2877")),o=Object(s["a"])(c,r,n,!1,null,"c56cf7ea",null);e["default"]=o.exports},c8bc:function(t,e,a){"use strict";a("edbe")},edbe:function(t,e,a){},f352:function(t,e,a){"use strict";a.d(e,"l",(function(){return n})),a.d(e,"m",(function(){return u})),a.d(e,"k",(function(){return i})),a.d(e,"g",(function(){return c})),a.d(e,"i",(function(){return s})),a.d(e,"h",(function(){return o})),a.d(e,"c",(function(){return d})),a.d(e,"d",(function(){return l})),a.d(e,"f",(function(){return m})),a.d(e,"a",(function(){return f})),a.d(e,"e",(function(){return p})),a.d(e,"j",(function(){return h})),a.d(e,"b",(function(){return b}));var r=a("b775");function n(t){return Object(r["a"])({url:"/api/metadata/getTables",method:"get",params:t})}function u(t){return Object(r["a"])({url:"/api/metadata/getViews",method:"get",params:t})}function i(t){return Object(r["a"])({url:"/api/metadata/getDBSchema",method:"get",params:t})}function c(t){return Object(r["a"])({url:"/api/metadata/getColumns",method:"get",params:t})}function s(t){return Object(r["a"])({url:"/api/metadata/getColumnsInfo",method:"get",params:t})}function o(t){return Object(r["a"])({url:"/api/metadata/getColumnsByQuerySql",method:"get",params:t})}function d(t){return Object(r["a"])({url:"/api/metadata/createTable",method:"post",params:t})}function l(t){return Object(r["a"])({url:"/api/metadata/createTable",method:"post",data:t})}function m(t){return Object(r["a"])({url:"/api/metadata/dropTable",method:"delete",params:t})}function f(t){return Object(r["a"])({url:"/api/metadata/alterTable",method:"post",data:t})}function p(t){return Object(r["a"])({url:"/api/metadata/createView",method:"post",data:t})}function h(t){return Object(r["a"])({url:"/api/metadata/getIndexes",method:"get",params:t})}function b(t){return Object(r["a"])({url:"/api/metadata/createIndex",method:"post",data:t})}}}]);