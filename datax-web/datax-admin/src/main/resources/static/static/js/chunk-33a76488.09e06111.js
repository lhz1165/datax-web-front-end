(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33a76488"],{"0112":function(t,e,a){"use strict";a.d(e,"d",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i})),a.d(e,"e",(function(){return o})),a.d(e,"b",(function(){return l})),a.d(e,"f",(function(){return c}));a("6b54"),a("ac6a");var s=a("b775");function r(t){return Object(s["a"])({url:"/api/jobApi",method:"get",params:t})}function n(t){return Object(s["a"])({url:"/api/jobApi/".concat(t),method:"get"})}function i(t){return Object(s["a"])({url:"/api/jobApi",method:"post",data:t})}function o(t){return Object(s["a"])({url:"/api/jobApi",method:"put",data:t})}function l(t){return Object(s["a"])({url:"/api/jobApi",method:"delete",params:{idList:t},paramsSerializer:function(t){var e=new URLSearchParams;return Array.isArray(t.idList)?t.idList.forEach((function(t){return e.append("idList",t)})):void 0!==t.idList&&null!==t.idList&&e.append("idList",t.idList),e.toString()}})}function c(t){return Object(s["a"])({url:"/api/jobApi/status",method:"post",data:t})}},"386d":function(t,e,a){"use strict";var s=a("cb7c"),r=a("83a1"),n=a("5f1b");a("214f")("search",1,(function(t,e,a,i){return[function(a){var s=t(this),r=void 0==a?void 0:a[e];return void 0!==r?r.call(a,s):new RegExp(a)[e](String(s))},function(t){var e=i(a,t,this);if(e.done)return e.value;var o=s(t),l=String(this),c=o.lastIndex;r(c,0)||(o.lastIndex=0);var u=n(o,l);return r(o.lastIndex,c)||(o.lastIndex=c),null===u?-1:u.index}]}))},"540b":function(t,e,a){},7514:function(t,e,a){"use strict";var s=a("5ca1"),r=a("0a49")(5),n="find",i=!0;n in[]&&Array(1)[n]((function(){i=!1})),s(s.P+s.F*i,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(n)},"7b11":function(t,e,a){"use strict";a("540b")},"7e39":function(t,e,a){"use strict";a.d(e,"e",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"g",(function(){return i})),a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return l})),a.d(e,"f",(function(){return c})),a.d(e,"d",(function(){return u}));var s=a("b775");function r(t){return Object(s["a"])({url:"/api/jobJdbcDatasource",method:"get",params:t})}function n(t){return Object(s["a"])({url:"/api/jobJdbcDatasource/"+t,method:"get"})}function i(t){return Object(s["a"])({url:"/api/jobJdbcDatasource",method:"put",data:t})}function o(t){return Object(s["a"])({url:"/api/jobJdbcDatasource",method:"post",data:t})}function l(t){return Object(s["a"])({url:"/api/jobJdbcDatasource",method:"delete",params:t})}function c(t){return Object(s["a"])({url:"/api/jobJdbcDatasource/test",method:"post",data:t})}function u(t){return Object(s["a"])({url:"/api/jobJdbcDatasource/all",method:"get",params:t})}},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},b312:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"api-edit-page"},[a("div",{staticClass:"page-header"},[a("div",{staticClass:"title-area"},[a("span",{staticClass:"title"},[t._v("API 参数配置")]),t._v(" "),t.apiId?a("span",{staticClass:"sub"},[t._v("ID: "+t._s(t.apiId))]):t._e()]),t._v(" "),a("div",{staticClass:"actions"},[a("el-button",{on:{click:t.handleBack}},[t._v("返回")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("保存")]),t._v(" "),2===t.currentStatus?a("el-button",{attrs:{type:"warning"},on:{click:t.handlePublish}},[t._v("取消发布")]):a("el-button",{attrs:{type:"success"},on:{click:t.handlePublish}},[t._v("发布")])],1)]),t._v(" "),a("el-card",{staticClass:"card-body",attrs:{shadow:"never"}},[a("el-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"1. 数据源与对象",name:"basic"}},[a("div",{staticClass:"form-row"},[a("el-form",{attrs:{model:t.basicForm,"label-width":"100px",inline:""}},[a("el-form-item",{attrs:{label:"数据源"}},[a("el-select",{staticStyle:{width:"260px"},attrs:{placeholder:"选择数据源",filterable:"",disabled:!!t.routeDatasourceId},on:{change:t.handleDatasourceChange},model:{value:t.basicForm.datasourceId,callback:function(e){t.$set(t.basicForm,"datasourceId",e)},expression:"basicForm.datasourceId"}},t._l(t.datasourceList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.datasourceName||t.datasource,value:t.id}})})),1)],1),t._v(" "),t.isPostgreSQL?a("el-form-item",{attrs:{label:"Schema"}},[a("el-select",{staticStyle:{width:"260px"},attrs:{placeholder:"请选择Schema",filterable:"",loading:t.loadingSchemas},on:{change:t.handleSchemaChange},model:{value:t.basicForm.tableSchema,callback:function(e){t.$set(t.basicForm,"tableSchema",e)},expression:"basicForm.tableSchema"}},t._l(t.schemaList,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"对象类型"}},[a("el-radio-group",{on:{change:t.handleTargetTypeChange},model:{value:t.basicForm.targetType,callback:function(e){t.$set(t.basicForm,"targetType",e)},expression:"basicForm.targetType"}},[a("el-radio-button",{attrs:{label:"table"}},[t._v("表")]),t._v(" "),a("el-radio-button",{attrs:{label:"view"}},[t._v("视图")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"table"===t.basicForm.targetType?"选择表":"选择视图"}},[a("el-select",{staticStyle:{width:"260px"},attrs:{placeholder:"请选择",filterable:"",loading:t.loadingTargets},on:{change:t.handleTargetChange},model:{value:t.basicForm.targetName,callback:function(e){t.$set(t.basicForm,"targetName",e)},expression:"basicForm.targetName"}},t._l(t.targetList,(function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})})),1)],1)],1)],1),t._v(" "),a("div",{staticClass:"table-wrapper"},[a("div",{staticClass:"table-head"},[t._v("字段列表")]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingColumns,expression:"loadingColumns"}],attrs:{data:t.columnList,border:"",size:"small",height:"360px"}},[a("el-table-column",{attrs:{prop:"name",label:"字段",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"comment",label:"描述"}}),t._v(" "),a("el-table-column",{attrs:{label:"请求参数",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-checkbox",{attrs:{value:t.isRequestSelected(e.row.name)},on:{change:function(a){return t.toggleRequestParam(e.row,a)}}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"返回参数",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-checkbox",{attrs:{value:t.isResponseSelected(e.row.name)},on:{change:function(a){return t.toggleResponseParam(e.row,a)}}})]}}])})],1)],1)]),t._v(" "),a("el-tab-pane",{attrs:{label:"2. 参数选择",name:"select"}},[a("div",{staticClass:"table-split"},[a("div",{staticClass:"table-block"},[a("div",{staticClass:"table-head"},[t._v("请求参数")]),t._v(" "),a("el-table",{attrs:{data:t.requestParams,border:"",size:"small",height:"320px"}},[a("el-table-column",{attrs:{prop:"name",label:"字段",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"comment",label:"描述"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.removeRequestParam(e.row.name)}}},[t._v("移除")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"table-block"},[a("div",{staticClass:"table-head"},[t._v("返回参数")]),t._v(" "),a("el-table",{attrs:{data:t.responseParams,border:"",size:"small",height:"320px"}},[a("el-table-column",{attrs:{prop:"name",label:"字段",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{prop:"comment",label:"描述"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.removeResponseParam(e.row.name)}}},[t._v("移除")])]}}])})],1)],1)])]),t._v(" "),a("el-tab-pane",{attrs:{label:"3. 配置请求参数",name:"requestConfig"}},[a("el-table",{attrs:{data:t.requestParams,border:"",size:"small",height:"380px"}},[a("el-table-column",{attrs:{prop:"name",label:"参数名",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{label:"类型",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini"},model:{value:e.row.paramType,callback:function(a){t.$set(e.row,"paramType",a)},expression:"scope.row.paramType"}},t._l(t.paramTypeOptions,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作符",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini"},model:{value:e.row.operator,callback:function(a){t.$set(e.row,"operator",a)},expression:"scope.row.operator"}},t._l(t.operatorOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"描述"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"参数说明"},model:{value:e.row.description,callback:function(a){t.$set(e.row,"description",a)},expression:"scope.row.description"}})]}}])})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"4. 配置返回参数",name:"responseConfig"}},[a("el-table",{attrs:{data:t.responseParams,border:"",size:"small",height:"380px"}},[a("el-table-column",{attrs:{prop:"name",label:"字段",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{label:"类型",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini"},model:{value:e.row.paramType,callback:function(a){t.$set(e.row,"paramType",a)},expression:"scope.row.paramType"}},t._l(t.paramTypeOptions,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"描述"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"返回字段说明"},model:{value:e.row.description,callback:function(a){t.$set(e.row,"description",a)},expression:"scope.row.description"}})]}}])})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"5. 测试API",name:"test"}},[a("div",{staticClass:"test-api-container"},[a("div",{staticClass:"test-api-header"},[a("div",{staticClass:"api-info"},[a("el-select",{staticClass:"method-select",attrs:{size:"small"},model:{value:t.apiMethod,callback:function(e){t.apiMethod=e},expression:"apiMethod"}},[a("el-option",{attrs:{label:"GET",value:"GET"}}),t._v(" "),a("el-option",{attrs:{label:"POST",value:"POST"}}),t._v(" "),a("el-option",{attrs:{label:"PUT",value:"PUT"}}),t._v(" "),a("el-option",{attrs:{label:"DELETE",value:"DELETE"}})],1),t._v(" "),a("el-input",{staticClass:"path-input",attrs:{placeholder:"/api/ds/v1/...",size:"small"},model:{value:t.apiPath,callback:function(e){t.apiPath=e},expression:"apiPath"}}),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.testing,size:"small"},on:{click:t.handleTestApi}},[t._v("发送")])],1)]),t._v(" "),a("div",{staticClass:"test-body-container"},[a("div",{staticClass:"test-request-section"},[a("div",{staticClass:"section-header"},[a("span",{staticClass:"section-title"},[t._v("请求体 (Body)")]),t._v(" "),t.requestParams.length>0?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:t.generateSampleJson}},[t._v("\n                  生成示例\n                ")]):t._e()],1),t._v(" "),a("div",{staticClass:"json-editor-wrapper"},[a("el-input",{staticClass:"json-textarea",attrs:{type:"textarea",rows:15,placeholder:'请输入JSON格式的请求参数，例如：\\n{\\n  "param1": "value1",\\n  "param2": 123\\n}'},model:{value:t.requestBodyJson,callback:function(e){t.requestBodyJson=e},expression:"requestBodyJson"}})],1),t._v(" "),t.requestParams.length>0?a("div",{staticClass:"params-hint"},[a("div",{staticClass:"hint-title"},[t._v("可用参数：")]),t._v(" "),a("div",{staticClass:"params-list"},t._l(t.requestParams,(function(e){return a("el-tag",{key:e.name,staticClass:"param-tag",attrs:{size:"mini"}},[t._v("\n                    "+t._s(e.name)+" ("+t._s(e.paramType)+")\n                  ")])})),1)]):t._e()]),t._v(" "),a("div",{staticClass:"test-response-section"},[a("div",{staticClass:"section-header"},[a("span",{staticClass:"section-title"},[t._v("响应")]),t._v(" "),null!==t.responseTime?a("span",{staticClass:"response-time"},[t._v("耗时: "+t._s(t.responseTime)+"ms")]):t._e()]),t._v(" "),t.testResponse?a("div",{staticClass:"json-editor-wrapper"},[a("el-input",{staticClass:"json-textarea response-textarea",attrs:{value:t.formatResponse(t.testResponse),type:"textarea",rows:15,readonly:""}})],1):a("div",{staticClass:"empty-response"},[a("i",{staticClass:"el-icon-info"}),t._v(" "),a("span",[t._v('点击"发送"按钮测试API')])])])])])])],1)],1)],1)},r=[],n=(a("ac6a"),a("f559"),a("386d"),a("6762"),a("2fdb"),a("c5f6"),a("7f7f"),a("7514"),a("7e39")),i=a("f352"),o=a("0112"),l=a("cee4"),c={name:"ApiPublishEdit",data:function(){return{apiId:this.$route.query.id,routeDatasourceId:this.$route.query.datasourceId,routeDataSource:this.$route.query.dataSource,activeTab:"basic",datasourceList:[],basicForm:{datasourceId:void 0,targetType:"table",targetName:"",tableSchema:""},targetList:[],columnList:[],requestParams:[],responseParams:[],paramTypeOptions:["string","int","long","double","bool","date"],operatorOptions:[{label:"=",value:"equal"},{label:"!=",value:"notEqual"},{label:">",value:"greaterThan"},{label:"<",value:"lessThan"},{label:">=",value:"greaterThanOrEqual"},{label:"<=",value:"lessThanOrEqual"},{label:"LIKE",value:"like"},{label:"IN",value:"in"}],operatorValueMap:{"=":"equal","!=":"notEqual",">":"greaterThan","<":"lessThan",">=":"greaterThanOrEqual","<=":"lessThanOrEqual",LIKE:"like",IN:"in"},loadingTargets:!1,loadingColumns:!1,schemaList:[],loadingSchemas:!1,currentStatus:1,apiPath:"",apiMethod:"GET",requestBodyJson:"{}",testResponse:null,responseTime:null,testing:!1}},computed:{isPostgreSQL:function(){return"postgresql"===this.routeDataSource||"postgresql"===this.currentDataSource},currentDataSource:function(){var t=this;if(this.routeDataSource)return this.routeDataSource;var e=this.datasourceList.find((function(e){return e.id===t.basicForm.datasourceId}));return e?e.datasource:""}},watch:{activeTab:function(t){"test"===t&&this.requestParams.length>0&&this.generateEmptyJson()},requestParams:{handler:function(){"test"===this.activeTab&&this.requestParams.length>0&&this.generateEmptyJson()},deep:!0}},created:function(){this.getDatasourceList()},methods:{handleBack:function(){this.$router.back()},handleSave:function(){var t=this,e=this.requestParams.map((function(e){var a=e.operator||"equal";return t.operatorValueMap[a]&&(a=t.operatorValueMap[a]),{field:e.name,type:e.paramType||e.type,desc:e.description||e.comment||"",operator:a}})),a=this.responseParams.map((function(t){return{field:t.name,type:t.paramType||t.type,desc:t.description||t.comment||""}})),s={targetType:this.basicForm.targetType,targetName:this.basicForm.targetName,tableSchema:this.basicForm.tableSchema||"",requestParam:e,responseParam:a},r={id:this.apiId,datasourceId:this.basicForm.datasourceId,targetType:this.basicForm.targetType,targetName:this.basicForm.targetName,tableSchema:this.basicForm.tableSchema,config:JSON.stringify(s)};o["e"](r).then((function(){t.$message.success("保存成功")})).catch((function(){t.$message.error("保存失败")}))},handlePublish:function(){var t=this;if(this.apiId){var e=2===this.currentStatus?1:2,a=2===e?"发布":"取消发布";o["f"]({id:this.apiId,status:e}).then((function(){t.currentStatus=e,t.$message.success("".concat(a,"成功"))})).catch((function(){t.$message.error("".concat(a,"失败"))}))}else this.$message.warning("请先保存API配置")},getDatasourceList:function(){var t=this;n["d"]().then((function(e){t.datasourceList=e||[],t.initDatasourceFromRoute(),t.apiId&&t.loadApiDetail()})).catch((function(){t.datasourceList=[],t.initDatasourceFromRoute(),t.apiId&&t.loadApiDetail()}))},loadApiDetail:function(){var t=this;o["c"](this.apiId).then((function(e){if(e&&(t.currentStatus=e.status||1,t.apiPath=e.path||"",t.apiMethod=e.method||"GET",e.datasourceId&&(t.basicForm.datasourceId=e.datasourceId),e.config))try{var a="string"===typeof e.config?JSON.parse(e.config):e.config;a.targetType&&(t.basicForm.targetType=a.targetType),a.targetName&&(t.basicForm.targetName=a.targetName),a.tableSchema&&(t.basicForm.tableSchema=a.tableSchema),a.requestParam&&Array.isArray(a.requestParam)&&(t.requestParams=a.requestParam.map((function(t){return{name:t.field,type:t.type,paramType:t.type,comment:t.desc||"",description:t.desc||"",operator:t.operator||"equal"}}))),a.responseParam&&Array.isArray(a.responseParam)&&(t.responseParams=a.responseParam.map((function(t){return{name:t.field,type:t.type,paramType:t.type,comment:t.desc||"",description:t.desc||""}}))),t.$nextTick((function(){t.basicForm.datasourceId&&t.basicForm.targetName&&(t.isPostgreSQL&&t.basicForm.tableSchema?t.loadSchemaList().then((function(){t.loadTargetList().then((function(){t.loadColumnList()}))})):t.loadTargetList().then((function(){t.loadColumnList()})))}))}catch(s){console.error("解析 config 失败:",s),t.$message.warning("配置解析失败，请重新配置")}})).catch((function(){t.$message.error("加载 API 详情失败")}))},initDatasourceFromRoute:function(){this.routeDatasourceId?(this.basicForm.datasourceId=Number(this.routeDatasourceId),this.isPostgreSQL?this.loadSchemaList():this.loadTargetList()):!this.basicForm.datasourceId&&this.datasourceList.length&&(this.basicForm.datasourceId=this.datasourceList[0].id,this.isPostgreSQL?this.loadSchemaList():this.loadTargetList())},loadSchemaList:function(){var t=this;return new Promise((function(e){if(!t.basicForm.datasourceId)return t.schemaList=[],void e();t.loadingSchemas=!0;var a={datasourceId:t.basicForm.datasourceId};i["k"](a).then((function(a){t.schemaList=a||[],t.loadingSchemas=!1,t.schemaList.length>0&&!t.basicForm.tableSchema?(t.basicForm.tableSchema=t.schemaList[0],t.loadTargetList().then((function(){return e()}))):0===t.schemaList.length?t.loadTargetList().then((function(){return e()})):e()})).catch((function(){t.schemaList=[],t.loadingSchemas=!1,t.loadTargetList().then((function(){return e()}))}))}))},handleSchemaChange:function(){this.basicForm.targetName="",this.columnList=[],this.clearSelectedParams(),this.loadTargetList()},loadTargetList:function(){var t=this;return new Promise((function(e){if(!t.basicForm.datasourceId)return t.targetList=[],void e();if(t.isPostgreSQL&&!t.basicForm.tableSchema)return t.targetList=[],void e();t.loadingTargets=!0;var a={datasourceId:t.basicForm.datasourceId};t.isPostgreSQL&&t.basicForm.tableSchema&&(a.tableSchema=t.basicForm.tableSchema);var s="table"===t.basicForm.targetType?i["l"]:i["m"];s(a).then((function(a){t.targetList=(a||[]).map((function(t){return{name:t}})),t.loadingTargets=!1,t.targetList.length>0&&!t.basicForm.targetName&&(t.basicForm.targetName=t.targetList[0].name,t.loadColumnList()),e()})).catch((function(){t.targetList=[],t.loadingTargets=!1,e()}))}))},loadColumnList:function(){var t=this;if(this.basicForm.datasourceId&&this.basicForm.targetName)if(!this.isPostgreSQL||this.basicForm.tableSchema){this.loadingColumns=!0;var e={datasourceId:this.basicForm.datasourceId,tableName:this.basicForm.targetName};this.isPostgreSQL&&this.basicForm.tableSchema&&(e.tableSchema=this.basicForm.tableSchema),i["i"](e).then((function(e){t.columnList=(e||[]).map((function(t){return{name:t.name,type:t.type||"-",comment:t.comment||""}})),t.loadingColumns=!1})).catch((function(){t.columnList=[],t.loadingColumns=!1}))}else this.columnList=[];else this.columnList=[]},handleDatasourceChange:function(){this.basicForm.targetName="",this.basicForm.tableSchema="",this.columnList=[],this.targetList=[],this.schemaList=[],this.clearSelectedParams(),this.isPostgreSQL?this.loadSchemaList():this.loadTargetList()},handleTargetTypeChange:function(){this.basicForm.targetName="",this.columnList=[],this.clearSelectedParams(),this.loadTargetList()},handleTargetChange:function(){this.columnList=[],this.clearSelectedParams(),this.loadColumnList()},addRequestParam:function(t){this.requestParams.find((function(e){return e.name===t.name}))||this.requestParams.push({name:t.name,type:t.type,comment:t.comment,paramType:this.mapType(t.type),operator:"equal",description:t.comment||""})},addResponseParam:function(t){this.responseParams.find((function(e){return e.name===t.name}))||this.responseParams.push({name:t.name,type:t.type,comment:t.comment,paramType:this.mapType(t.type),description:t.comment||""})},toggleRequestParam:function(t,e){e?this.addRequestParam(t):this.removeRequestParam(t.name)},toggleResponseParam:function(t,e){e?this.addResponseParam(t):this.removeResponseParam(t.name)},isRequestSelected:function(t){return this.requestParams.some((function(e){return e.name===t}))},isResponseSelected:function(t){return this.responseParams.some((function(e){return e.name===t}))},removeRequestParam:function(t){this.requestParams=this.requestParams.filter((function(e){return e.name!==t}))},removeResponseParam:function(t){this.responseParams=this.responseParams.filter((function(e){return e.name!==t}))},clearSelectedParams:function(){this.requestParams=[],this.responseParams=[]},mapType:function(t){var e=(t||"").toLowerCase();return e.includes("int")?"int":e.includes("bigint")?"long":e.includes("double")||e.includes("float")||e.includes("decimal")?"double":e.includes("date")||e.includes("time")?"date":"string"},handleTestApi:function(){var t=this;if(this.apiPath){var e={};try{this.requestBodyJson&&this.requestBodyJson.trim()&&(e=JSON.parse(this.requestBodyJson))}catch(o){return void this.$message.error("请求体JSON格式错误："+o.message)}this.testing=!0,this.testResponse=null,this.responseTime=null;var a=Date.now(),s=this.apiPath;try{var r=new URL(s,"http://localhost");s=r.pathname+(r.search||"")}catch(o){}s.startsWith("/")||(s="/"+s);var n="http://localhost:8180"+s,i={url:n,method:this.apiMethod.toLowerCase(),headers:{"Content-Type":"application/json"}};"GET"===this.apiMethod.toUpperCase()?i.params=e:i.data=e,Object(l["a"])(i).then((function(e){var s=Date.now();t.responseTime=s-a,t.testResponse=e.data})).catch((function(e){var s=Date.now();t.responseTime=s-a,e.response?t.testResponse={error:!0,status:e.response.status,message:e.response.data&&e.response.data.message||e.message,data:e.response.data}:t.testResponse={error:!0,message:e.message||"请求失败"}})).finally((function(){t.testing=!1}))}else this.$message.warning("API路径未配置")},generateEmptyJson:function(){var t={};this.requestParams.forEach((function(e){switch(e.paramType){case"int":case"long":t[e.name]=null;break;case"double":t[e.name]=null;break;case"bool":t[e.name]=null;break;case"date":t[e.name]="";break;default:t[e.name]=""}})),this.requestBodyJson=JSON.stringify(t,null,2)},generateSampleJson:function(){var t={};this.requestParams.forEach((function(e){switch(e.paramType){case"int":t[e.name]=0;break;case"long":t[e.name]=0;break;case"double":t[e.name]=0;break;case"bool":t[e.name]=!1;break;case"date":t[e.name]=(new Date).toISOString();break;default:t[e.name]=""}})),this.requestBodyJson=JSON.stringify(t,null,2)},formatResponse:function(t){if("string"===typeof t)try{return JSON.stringify(JSON.parse(t),null,2)}catch(e){return t}return JSON.stringify(t,null,2)}}},u=c,m=(a("7b11"),a("2877")),d=Object(m["a"])(u,s,r,!1,null,"3be611c3",null);e["default"]=d.exports},f352:function(t,e,a){"use strict";a.d(e,"l",(function(){return r})),a.d(e,"m",(function(){return n})),a.d(e,"k",(function(){return i})),a.d(e,"g",(function(){return o})),a.d(e,"i",(function(){return l})),a.d(e,"h",(function(){return c})),a.d(e,"c",(function(){return u})),a.d(e,"d",(function(){return m})),a.d(e,"f",(function(){return d})),a.d(e,"a",(function(){return p})),a.d(e,"e",(function(){return h})),a.d(e,"j",(function(){return b})),a.d(e,"b",(function(){return f}));var s=a("b775");function r(t){return Object(s["a"])({url:"/api/metadata/getTables",method:"get",params:t})}function n(t){return Object(s["a"])({url:"/api/metadata/getViews",method:"get",params:t})}function i(t){return Object(s["a"])({url:"/api/metadata/getDBSchema",method:"get",params:t})}function o(t){return Object(s["a"])({url:"/api/metadata/getColumns",method:"get",params:t})}function l(t){return Object(s["a"])({url:"/api/metadata/getColumnsInfo",method:"get",params:t})}function c(t){return Object(s["a"])({url:"/api/metadata/getColumnsByQuerySql",method:"get",params:t})}function u(t){return Object(s["a"])({url:"/api/metadata/createTable",method:"post",params:t})}function m(t){return Object(s["a"])({url:"/api/metadata/createTable",method:"post",data:t})}function d(t){return Object(s["a"])({url:"/api/metadata/dropTable",method:"delete",params:t})}function p(t){return Object(s["a"])({url:"/api/metadata/alterTable",method:"post",data:t})}function h(t){return Object(s["a"])({url:"/api/metadata/createView",method:"post",data:t})}function b(t){return Object(s["a"])({url:"/api/metadata/getIndexes",method:"get",params:t})}function f(t){return Object(s["a"])({url:"/api/metadata/createIndex",method:"post",data:t})}}}]);